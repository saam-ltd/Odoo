<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <!-- Picking Form View Inherit -->
    <record id="view_stock_form_inherit" model="ir.ui.view">
        <field name="name">picking.form.view.inherit</field>
        <field name="model">stock.picking</field>
        <field name="inherit_id" ref="stock.view_picking_form"/>
        <field name="arch" type="xml">

            <button name="action_toggle_is_locked" position="after">
                <button name="action_update_del_status_scan" string="Scan" type="object" class="oe_highlight"  attrs="{'invisible': ['|',('state', '!=','done'),('del_schedule_status', '=','scanned')]}"/>
            </button>

            <xpath expr="//div[@name='button_box']" position="after">
                <widget name="web_ribbon" text="Not Scheduled" bg_color="bg-danger" attrs="{'invisible': [('del_schedule_status', '!=','not_scheduled')]}"/>
               <widget name="web_ribbon" text="Scheduled" bg_color="bg-success" attrs="{'invisible': [('del_schedule_status', '!=','scheduled')]}"/>
               <widget name="web_ribbon" text="Re-Scheduled" bg_color="bg-success" attrs="{'invisible': [('del_schedule_status', '!=','re_scheduled')]}"/>
               <widget name="web_ribbon" text="Scanned" bg_color="bg-success" attrs="{'invisible': [('del_schedule_status', '!=','scanned')]}"/>
            </xpath>

            <field name="origin" position="after">
                <field name="p_o_ref" readonly="1" attrs="{'invisible': [('p_o_ref', '=',False)]}"/>
                <field name="del_schedule_status" readonly="1" invisible="1"/>
                <!-- <field name="is_sch_resch" readonly="1"/> -->
                <!-- <field name="is_date_updated"/> -->
            </field>
            <field name="user_id" position="after">
                <field name="custom_salesperson_id" options="{'no_create': True, 'no_edit': True, 'no_open': True}" attrs="{'readonly': [('state', 'in',('done','cancel'))]}"/>
                <!-- <field name="logistic_duration_id" options="{'no_create': True, 'no_edit': True, 'no_open': True}" attrs="{'readonly': [('state', 'in',('done','cancel'))]}"/> -->
                <field name="customer_category_id" options="{'no_create': True, 'no_edit': True, 'no_open': True}" attrs="{'readonly': [('state', 'in',('done','cancel'))]}"/>
                <field name="customer_remarks" attrs="{'readonly': [('state', 'in',('done','cancel'))]}"/>
            </field>
            <xpath expr="//notebook/page[2]/field/tree/field[@name='product_id']" position="after">
                <field name="prod_boxes" attrs="{'readonly': [('state', 'in',('done','cancel'))]}" string="Orders"/>
            </xpath>
            <xpath expr="//notebook/page[2]/field/form/group/field[@name='product_id']" position="after">
                <field name="prod_boxes" attrs="{'readonly': [('state', 'in',('done','cancel'))]}" string="Orders"/>
            </xpath>
            <xpath expr="//field[@name='scheduled_date']" position="attributes">
                <attribute name="attrs">{'readonly': [('state', '!=', 'assigned'),('picking_type_code', '=', 'outgoing')]}</attribute>
            </xpath>
        </field>
    </record>

    <record id="view_stock_move_line_detailed_tree_inherit_boxes" model="ir.ui.view">
        <field name="name">detailed.view.inherit</field>
        <field name="model">stock.move.line</field>
        <field name="inherit_id" ref="stock.view_stock_move_line_detailed_operation_tree"/>
        <field name="arch" type="xml">
             <field name="product_id" position="after">
                <field name="prod_boxes" attrs="{'readonly': [('state', 'in',('done','cancel'))]}" string="Orders"/>
            </field>
        </field>
    </record> 

    <record id="view_move_line_form_inherit_boxes" model="ir.ui.view">
        <field name="name">detailed.view.inherit.form</field>
        <field name="model">stock.move.line</field>
        <field name="inherit_id" ref="stock.view_move_line_form"/>
        <field name="arch" type="xml">
             <field name="product_id" position="after">
                <field name="prod_boxes" attrs="{'readonly': [('state', 'in',('done','cancel'))]}" string="Orders"/>
            </field>
        </field>
    </record> 

    <!-- Picking Tree View Inherit -->
    <record id="view_stock_tree_inherit" model="ir.ui.view">
        <field name="name">picking.tree.view.inherit</field>
        <field name="model">stock.picking</field>
        <field name="inherit_id" ref="stock.vpicktree"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='origin']" position="before">
                <field name="custom_salesperson_id"/>
            </xpath>
            <xpath expr="//field[@name='scheduled_date']" position="replace">
                <field name="scheduled_date"/>
            </xpath>
             <xpath expr="//field[@name='state']" position="after">
                <field name="del_schedule_status"  widget="badge" decoration-success="del_schedule_status in ('scheduled','re_scheduled')" decoration-danger="del_schedule_status == 'not_scheduled'" decoration-info="del_schedule_status == 'scanned'"/>
            </xpath>
        </field>
    </record>

    <!-- Picking View - Search view inherit -->
    <record id="view_picking_internal_search_inheirt" model="ir.ui.view">
        <field name="name">stock.picking.internal.search.inherit</field>
        <field name="model">stock.picking</field>
        <field name="inherit_id" ref="stock.view_picking_internal_search"/>
        <field name="arch" type="xml">
            <xpath expr="//search" type="inside">
                <field name="p_o_ref"/>
                <field name="custom_salesperson_id"/>
                <!-- <field name="logistic_duration_id"/> -->
                <field name="customer_category_id"/>
                <field name="customer_remarks"/>
                <!-- Group By -->
                <filter name="group_by_p_o_ref" string="Custom PO Reference" context="{'group_by': 'p_o_ref'}"/>
                <filter name="group_by_custom_salesperson_id" string="Custom Salesperson" context="{'group_by': 'custom_salesperson_id'}"/>
                <filter name="group_by_del_schedule_status" string="Del Schedule Status" context="{'group_by': 'del_schedule_status'}"/>
            </xpath>
        </field>
    </record>


    <!-- Menu's for Sales Person -->    

    <record id="stock_picking_type_action_sales_person" model="ir.actions.act_window">
        <field name="name">Inventory Overview</field>
        <field name="res_model">stock.picking.type</field>
        <field name="type">ir.actions.act_window</field>
        <field name="view_mode">kanban,form</field>
        <field name="domain">[('barcode', 'in', ['WH-DELIVERY','WH-RETURNS'])]</field>
        <field name="help" type="html">
          <p class="o_view_nocontent_smiling_face">
            Create a new operation type
          </p><p>
            The operation type system allows you to assign each stock
            operation a specific type which will alter its views accordingly.
            On the operation type you could e.g. specify if packing is needed by default,
            if it should show the customer.
          </p>
        </field>
    </record>

    <menuitem
        action="stock_picking_type_action_sales_person"
        id="stock_picking_type_menu_sales_person"
        parent="stock.menu_stock_root" sequence="0"
        groups="group_custom_sales_person"
        name="Overview"/>
</odoo>
